<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faith Journey | Harvest Family Church</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Montserrat:wght@300;500;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --accent: #FFD166;
            --dark: #2F4858;
            --light: #F7F9FC;
            --gradient: linear-gradient(135deg, #FF6B6B, #FFD166);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background: var(--gradient);
            padding: 30px 0;
            text-align: center;
            border-radius: 0 0 25px 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
        }
        
        header h1 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 800;
            font-size: 2.8rem;
            color: white;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.1);
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        
        header p {
            color: white;
            font-size: 1.2rem;
            font-weight: 300;
            opacity: 0.9;
        }
        
        .church-name {
            background-color: var(--accent);
            color: var(--dark);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-block;
            margin-top: 10px;
            transform: rotate(-2deg);
            box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .tab-container {
            background-color: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            margin-bottom: 40px;
        }
        
        .tabs {
            display: flex;
            flex-wrap: wrap;
            background-color: #f0f2f5;
            padding: 0 15px;
            border-bottom: 3px solid #f0f2f5;
            position: relative;
        }
        
        .tab-btn {
            background: none;
            border: none;
            padding: 18px 25px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--dark);
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
            opacity: 0.7;
            overflow: hidden;
        }
        
        .tab-btn:hover {
            opacity: 1;
        }
        
        .tab-btn:before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 3px;
            background-color: var(--primary);
            transition: width 0.3s;
        }
        
        .tab-btn.active {
            opacity: 1;
        }
        
        .tab-btn.active:before {
            width: 80%;
        }
        
        .tab-btn i {
            margin-right: 8px;
            font-size: 1.2rem;
            vertical-align: middle;
        }
        
        .tab-content {
            padding: 35px;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        h2 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 25px;
            font-size: 1.8rem;
            position: relative;
            display: inline-block;
        }
        
        h2:after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 40%;
            height: 3px;
            background: var(--gradient);
            border-radius: 10px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5ea;
            border-radius: 12px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            color: var(--dark);
            background-color: #f9fafc;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.2);
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .submit-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 15px 30px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(255, 107, 107, 0.4);
        }
        
        .submit-btn:active {
            transform: translateY(1px);
        }
        
        .submit-btn i {
            margin-right: 8px;
            font-size: 1.2rem;
        }
        
        .response-container {
            background-color: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            margin-top: 30px;
        }
        
        .response-header {
            background-color: var(--dark);
            color: white;
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .response-header h3 {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            font-size: 1.3rem;
        }
        
        #copy-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            opacity: 0.8;
            transition: all 0.3s;
        }
        
        #copy-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        .response-content {
            padding: 30px;
            min-height: 200px;
        }
        
        .welcome-message {
            text-align: center;
            padding: 30px 0;
        }
        
        .welcome-message i {
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .welcome-message h3 {
            font-family: 'Montserrat', sans-serif;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .welcome-message p {
            color: #667085;
            max-width: 600px;
            margin: 0 auto 15px;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px 0;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(78, 205, 196, 0.2);
            border-top: 5px solid var(--secondary);
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading p {
            color: var(--dark);
            font-weight: 500;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            color: #667085;
            font-size: 0.9rem;
        }
        
        .social-icons {
            margin-top: 15px;
        }
        
        .social-icons a {
            color: var(--dark);
            font-size: 1.5rem;
            margin: 0 10px;
            transition: all 0.3s;
        }
        
        .social-icons a:hover {
            color: var(--primary);
            transform: translateY(-3px);
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            header {
                padding: 20px 0;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            .tabs {
                flex-direction: column;
                padding: 0;
            }
            
            .tab-btn {
                width: 100%;
                text-align: left;
                border-bottom: 1px solid #e1e5ea;
            }
            
            .tab-btn.active:before {
                width: 5px;
                height: 80%;
                left: 0;
                top: 50%;
                transform: translateY(-50%);
            }
            
            .tab-content {
                padding: 25px 20px;
            }
            
            .submit-btn {
                width: 100%;
            }
        }

        /* Feature boxes for the welcome message */
        .feature-boxes {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature-box {
            flex: 1;
            min-width: 200px;
            background-color: #f9fafc;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .feature-box:hover {
            transform: translateY(-5px);
            border-color: var(--secondary);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }
        
        .feature-box i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .feature-box h4 {
            margin-bottom: 10px;
            font-family: 'Montserrat', sans-serif;
        }
        
        .feature-box p {
            font-size: 0.9rem;
            color: #667085;
        }

        /* Personal Journal Styles */
        .mood-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .mood-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 10px;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .mood-option:hover {
            background-color: #f0f2f5;
        }
        
        .mood-option.selected {
            border-color: var(--secondary);
            background-color: rgba(78, 205, 196, 0.1);
        }
        
        .mood-option i {
            font-size: 1.8rem;
            margin-bottom: 5px;
            color: var(--primary);
        }
        
        .mood-option span {
            font-size: 0.8rem;
            color: var(--dark);
        }
        
        .journal-entries {
            margin-top: 30px;
        }
        
        .journal-entry {
            background-color: #f9fafc;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--secondary);
            transition: all 0.3s;
        }
        
        .journal-entry:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .journal-entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .journal-entry-title {
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--dark);
        }
        
        .journal-entry-date {
            font-size: 0.9rem;
            color: #667085;
        }
        
        .journal-entry-mood {
            display: inline-block;
            margin-right: 10px;
        }
        
        .journal-entry-mood i {
            color: var(--primary);
        }
        
        .journal-entry-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        
        .journal-tag {
            background-color: rgba(78, 205, 196, 0.1);
            color: var(--secondary);
            font-size: 0.8rem;
            padding: 3px 10px;
            border-radius: 20px;
        }
        
        .journal-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .journal-action-btn {
            background: none;
            border: none;
            color: var(--dark);
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .journal-action-btn:hover {
            opacity: 1;
        }
        
        .journal-action-btn i {
            margin-right: 5px;
        }
        
        .filter-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .filter-control {
            flex: 1;
            min-width: 150px;
        }
        
        .search-control {
            flex: 2;
            position: relative;
        }
        
        .search-control input {
            padding-left: 40px;
        }
        
        .search-control i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #667085;
        }
        
        /* Voice Feature Styles */
        .voice-btn {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 1.2rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .voice-btn:hover {
            background-color: rgba(255, 107, 107, 0.1);
        }
        
        .voice-btn.active {
            color: white;
            background-color: var(--primary);
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }
        
        .voice-container {
            position: relative;
        }
        
        .voice-container input,
        .voice-container textarea {
            padding-right: 50px;
        }
        
        .voice-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .voice-control-btn {
            background: none;
            border: 1px solid #e1e5ea;
            color: var(--dark);
            cursor: pointer;
            font-size: 0.9rem;
            padding: 5px 10px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            transition: all 0.3s;
        }
        
        .voice-control-btn:hover {
            background-color: #f0f2f5;
        }
        
        .voice-control-btn i {
            margin-right: 5px;
        }
        
        .voice-status {
            font-size: 0.9rem;
            color: #667085;
        }
        
        .voice-transcript {
            background-color: #f9fafc;
            border: 1px solid #e1e5ea;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            max-height: 100px;
            overflow-y: auto;
            display: none;
        }
        
        .voice-transcript.active {
            display: block;
        }
        
        .tts-highlight {
            background-color: rgba(255, 209, 102, 0.3);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-seedling"></i> Faith Journey</h1>
            <p>Growing together in Christ</p>
            <div class="church-name">Harvest Family Church</div>
        </header>

        <div class="tab-container">
            <div class="tabs">
                <button class="tab-btn active" data-tab="quiet-time">
                    <i class="fas fa-book-reader"></i> Daily Quiet Time
                </button>
                <button class="tab-btn" data-tab="books">
                    <i class="fas fa-book"></i> Book Recommendations
                </button>
                <button class="tab-btn" data-tab="bible-study">
                    <i class="fas fa-bible"></i> Bible Study
                </button>
                <button class="tab-btn" data-tab="questions">
                    <i class="fas fa-question-circle"></i> Ask a Question
                </button>
                <button class="tab-btn" data-tab="journal">
                    <i class="fas fa-pen-to-square"></i> Personal Journal
                </button>
            </div>

            <div class="tab-content">
                <!-- Quiet Time Tab -->
                <div class="tab-pane active" id="quiet-time">
                    <h2>Daily Quiet Time Plan</h2>
                    <div class="form-group voice-container">
                        <label for="duration">How long do you want to spend with God? (minutes)</label>
                        <input type="number" id="duration" min="5" max="60" value="15">
                    </div>
                    <div class="form-group voice-container">
                        <label for="focus-area">What's on your heart today? (optional)</label>
                        <input type="text" id="focus-area" placeholder="e.g., anxiety, thankfulness, finding purpose">
                        <button class="voice-btn" id="focus-area-voice" title="Speak your thoughts">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    <button class="submit-btn" id="quiet-time-btn">
                        <i class="fas fa-pray"></i> Create My Plan
                    </button>
                </div>

                <!-- Book Recommendations Tab -->
                <div class="tab-pane" id="books">
                    <h2>Christian Book Recommendations</h2>
                    <div class="form-group voice-container">
                        <label for="book-topic">What are you interested in learning about?</label>
                        <input type="text" id="book-topic" placeholder="e.g., identity, relationships, purpose">
                        <button class="voice-btn" id="book-topic-voice" title="Speak your interest">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    <div class="form-group">
                        <label for="spiritual-level">Where are you in your faith journey?</label>
                        <select id="spiritual-level">
                            <option value="beginner">Just starting out</option>
                            <option value="intermediate">Growing steadily</option>
                            <option value="advanced">Seeking deeper understanding</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="book-count">How many suggestions would you like?</label>
                        <input type="number" id="book-count" min="1" max="5" value="3">
                    </div>
                    <button class="submit-btn" id="books-btn">
                        <i class="fas fa-search"></i> Find Books For Me
                    </button>
                </div>

                <!-- Bible Study Tab -->
                <div class="tab-pane" id="bible-study">
                    <h2>Bible Study Guide</h2>
                    <div class="form-group voice-container">
                        <label for="passage">What passage would you like to explore?</label>
                        <input type="text" id="passage" placeholder="e.g., John 3:16-21, Psalm 23, Romans 8">
                        <button class="voice-btn" id="passage-voice" title="Speak the passage">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    <button class="submit-btn" id="bible-study-btn">
                        <i class="fas fa-lightbulb"></i> Create My Study Guide
                    </button>
                </div>

                <!-- Questions Tab -->
                <div class="tab-pane" id="questions">
                    <h2>Ask a Faith Question</h2>
                    <div class="form-group voice-container">
                        <label for="question">What's on your mind?</label>
                        <textarea id="question" placeholder="e.g., Why do bad things happen to good people? How can I hear God's voice?"></textarea>
                        <button class="voice-btn" id="question-voice" title="Speak your question">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    <button class="submit-btn" id="question-btn">
                        <i class="fas fa-comment-dots"></i> Get Answer
                    </button>
                </div>

                <!-- Personal Journal Tab -->
                <div class="tab-pane" id="journal">
                    <h2>Personal Journal</h2>
                    
                    <!-- Journal Entry Form -->
                    <div id="journal-form">
                        <div class="form-group voice-container">
                            <label for="journal-title">Title</label>
                            <input type="text" id="journal-title" placeholder="Give your entry a title">
                            <button class="voice-btn" id="journal-title-voice" title="Speak your title">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                        
                        <div class="form-group">
                            <label for="journal-date">Date</label>
                            <input type="date" id="journal-date">
                        </div>
                        
                        <div class="form-group">
                            <label>How are you feeling today?</label>
                            <div class="mood-selector" id="mood-selector">
                                <div class="mood-option" data-mood="joyful">
                                    <i class="fas fa-smile-beam"></i>
                                    <span>Joyful</span>
                                </div>
                                <div class="mood-option" data-mood="peaceful">
                                    <i class="fas fa-dove"></i>
                                    <span>Peaceful</span>
                                </div>
                                <div class="mood-option" data-mood="anxious">
                                    <i class="fas fa-wind"></i>
                                    <span>Anxious</span>
                                </div>
                                <div class="mood-option" data-mood="sad">
                                    <i class="fas fa-cloud-rain"></i>
                                    <span>Sad</span>
                                </div>
                                <div class="mood-option" data-mood="confused">
                                    <i class="fas fa-question-circle"></i>
                                    <span>Confused</span>
                                </div>
                                <div class="mood-option" data-mood="grateful">
                                    <i class="fas fa-pray"></i>
                                    <span>Grateful</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group voice-container">
                            <label for="journal-content">Your Thoughts</label>
                            <textarea id="journal-content" placeholder="Share what's on your heart and mind..."></textarea>
                            <button class="voice-btn" id="journal-content-voice" title="Speak your thoughts">
                                <i class="fas fa-microphone"></i>
                            </button>
                            <div class="voice-transcript" id="journal-transcript"></div>
                            <div class="voice-controls">
                                <span class="voice-status" id="journal-voice-status">Click the microphone to start speaking</span>
                                <button class="voice-control-btn" id="journal-voice-pause" style="display: none;">
                                    <i class="fas fa-pause"></i> Pause
                                </button>
                                <button class="voice-control-btn" id="journal-voice-stop" style="display: none;">
                                    <i class="fas fa-stop"></i> Stop
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group voice-container">
                            <label for="journal-prayer">Prayer Requests (optional)</label>
                            <textarea id="journal-prayer" placeholder="Any prayers you'd like to remember..."></textarea>
                            <button class="voice-btn" id="journal-prayer-voice" title="Speak your prayer requests">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                        
                        <div class="form-group voice-container">
                            <label for="journal-scripture">Scripture Connection (optional)</label>
                            <input type="text" id="journal-scripture" placeholder="Any verses that spoke to you today">
                            <button class="voice-btn" id="journal-scripture-voice" title="Speak the scripture">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                        
                        <div class="form-group voice-container">
                            <label for="journal-tags">Tags (comma separated)</label>
                            <input type="text" id="journal-tags" placeholder="e.g., prayer, gratitude, struggle">
                            <button class="voice-btn" id="journal-tags-voice" title="Speak your tags">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                        
                        <button class="submit-btn" id="journal-save-btn">
                            <i class="fas fa-save"></i> Save Entry
                        </button>
                    </div>
                    
                    <!-- Journal History -->
                    <div class="journal-entries" id="journal-entries">
                        <h3>Your Journal History</h3>
                        
                        <div class="filter-controls">
                            <div class="search-control">
                                <i class="fas fa-search"></i>
                                <input type="text" id="journal-search" placeholder="Search your entries...">
                            </div>
                            <div class="filter-control">
                                <select id="journal-filter-mood">
                                    <option value="">All Moods</option>
                                    <option value="joyful">Joyful</option>
                                    <option value="peaceful">Peaceful</option>
                                    <option value="anxious">Anxious</option>
                                    <option value="sad">Sad</option>
                                    <option value="confused">Confused</option>
                                    <option value="grateful">Grateful</option>
                                </select>
                            </div>
                            <div class="filter-control">
                                <select id="journal-filter-date">
                                    <option value="">All Time</option>
                                    <option value="week">This Week</option>
                                    <option value="month">This Month</option>
                                    <option value="year">This Year</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="journal-entries-list">
                            <!-- Journal entries will be populated here -->
                            <p id="no-entries-message">Your journal entries will appear here. Start by creating your first entry above!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Response Container -->
            <div class="response-container" id="response-container">
                <div class="response-header">
                    <h3>Your Journey Guide</h3>
                    <div style="display: flex; gap: 10px;">
                        <button id="speak-response-btn" title="Listen to response" style="background: none; border: none; color: white; cursor: pointer; font-size: 1.2rem; opacity: 0.8;">
                            <i class="fas fa-volume-up"></i>
                        </button>
                        <button id="copy-btn" title="Copy to clipboard">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>
                <div class="response-content" id="response-content">
                    <div class="welcome-message">
                        <i class="fas fa-hands fa-3x"></i>
                        <h3>Welcome to Faith Journey!</h3>
                        <p>Hey there! We're stoked you're here to grow in your relationship with God. This is your personal space to explore faith in a way that speaks to you.</p>
                        <p>Select any of the features above to start your journey!</p>
                        
                        <div class="feature-boxes">
                            <div class="feature-box">
                                <i class="fas fa-book-reader"></i>
                                <h4>Daily Quiet Time</h4>
                                <p>Custom devotional plans that fit your schedule and speak to your heart.</p>
                            </div>
                            <div class="feature-box">
                                <i class="fas fa-book"></i>
                                <h4>Book Recommendations</h4>
                                <p>Discover reads that will challenge and inspire your faith journey.</p>
                            </div>
                            <div class="feature-box">
                                <i class="fas fa-bible"></i>
                                <h4>Bible Study</h4>
                                <p>Dive deeper into God's Word with personalized study guides.</p>
                            </div>
                            <div class="feature-box">
                                <i class="fas fa-question-circle"></i>
                                <h4>Faith Questions</h4>
                                <p>Get thoughtful answers to your biggest questions about God and faith.</p>
                            </div>
                            <div class="feature-box">
                                <i class="fas fa-pen-to-square"></i>
                                <h4>Personal Journal</h4>
                                <p>Record your thoughts, feelings, and spiritual journey with voice or text.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Finding wisdom just for you...</p>
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2025 Faith Journey | Harvest Family Church</p>
            <div class="social-icons">
                <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="#" title="TikTok"><i class="fab fa-tiktok"></i></a>
                <a href="#" title="YouTube"><i class="fab fa-youtube"></i></a>
                <a href="#" title="Spotify"><i class="fab fa-spotify"></i></a>
            </div>
        </footer>
    </div>

    <script>
        // Tab switching functionality
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabPanes = document.querySelectorAll('.tab-pane');
        const apiBaseUrl = 'http://localhost:8001'; // Change this if your API is on a different host/port

        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all buttons and panes
                tabBtns.forEach(b => b.classList.remove('active'));
                tabPanes.forEach(p => p.classList.remove('active'));
                
                // Add active class to clicked button
                btn.classList.add('active');
                
                // Show corresponding tab pane
                const tabId = btn.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Response container elements
        const loading = document.getElementById('loading');
        const responseContainer = document.getElementById('response-container');
        const responseContent = document.getElementById('response-content');

        // Show loading spinner
        function showLoading() {
            responseContent.style.display = 'none';
            loading.style.display = 'block';
        }

        // Show response content
        function showResponse(html) {
            loading.style.display = 'none';
            responseContent.style.display = 'block';
            responseContent.innerHTML = html;
        }

        // Handle API errors
        function handleError(error) {
            console.error('API Error:', error);
            showResponse(`
                <div style="text-align: center; padding: 30px;">
                    <i class="fas fa-exclamation-circle fa-3x" style="color: var(--primary); margin-bottom: 20px;"></i>
                    <h3>Oops! Something went wrong</h3>
                    <p>We couldn't connect to our spiritual guide right now. Please try again in a moment.</p>
                    <p><small>Error: ${error.message || 'Unknown error'}</small></p>
                </div>
            `);
        }

        // Format response as HTML
        function formatResponse(content) {
            // Process the response to add proper HTML formatting
            // This converts line breaks to <br> tags and looks for markdown-like formatting
            let formattedContent = content
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            return `<div class="formatted-response"><p>${formattedContent}</p></div>`;
        }

        // API call function
        async function callApi(endpoint, data) {
            try {
                const response = await fetch(`${apiBaseUrl}${endpoint}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                
                const result = await response.json();
                return result.result;
            } catch (error) {
                throw error;
            }
        }

        // Quiet Time form submission
        document.getElementById('quiet-time-btn').addEventListener('click', async () => {
            const duration = document.getElementById('duration').value;
            const focusArea = document.getElementById('focus-area').value;
            
            showLoading();
            
            try {
                const result = await callApi('/quiet-time', {
                    duration: parseInt(duration),
                    focus_area: focusArea || null
                });
                
                showResponse(formatResponse(result));
            } catch (error) {
                handleError(error);
            }
        });

        // Book Recommendations form submission
        document.getElementById('books-btn').addEventListener('click', async () => {
            const topic = document.getElementById('book-topic').value;
            const spiritualLevel = document.getElementById('spiritual-level').value;
            const count = document.getElementById('book-count').value;
            
            showLoading();
            
            try {
                const result = await callApi('/recommend-books', {
                    topic: topic || null,
                    spiritual_level: spiritualLevel,
                    count: parseInt(count)
                });
                
                showResponse(formatResponse(result));
            } catch (error) {
                handleError(error);
            }
        });

        // Bible Study form submission
        document.getElementById('bible-study-btn').addEventListener('click', async () => {
            const passage = document.getElementById('passage').value;
            
            if (!passage) {
                alert('Please enter a Bible passage');
                return;
            }
            
            showLoading();
            
            try {
                const result = await callApi('/bible-study', {
                    passage: passage
                });
                
                showResponse(formatResponse(result));
            } catch (error) {
                handleError(error);
            }
        });

        // Questions form submission
        document.getElementById('question-btn').addEventListener('click', async () => {
            const question = document.getElementById('question').value;
            
            if (!question) {
                alert('Please enter your question');
                return;
            }
            
            showLoading();
            
            try {
                const result = await callApi('/answer-question', {
                    question: question
                });
                
                showResponse(formatResponse(result));
            } catch (error) {
                handleError(error);
            }
        });

        // Copy button functionality
        const copyBtn = document.getElementById('copy-btn');

        copyBtn.addEventListener('click', () => {
            const content = responseContent.innerText;
            navigator.clipboard.writeText(content)
                .then(() => {
                    copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                    setTimeout(() => {
                        copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
                    }, 2000);
                })
                .catch(err => {
                    console.error('Failed to copy: ', err);
                });
        });

        // Personal Journal functionality
        // Initialize journal entries from localStorage
        let journalEntries = JSON.parse(localStorage.getItem('journalEntries')) || [];
        
        // Set today's date as default
        document.getElementById('journal-date').valueAsDate = new Date();
        
        // Mood selector functionality
        const moodOptions = document.querySelectorAll('.mood-option');
        let selectedMood = null;
        
        moodOptions.forEach(option => {
            option.addEventListener('click', () => {
                moodOptions.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                selectedMood = option.getAttribute('data-mood');
            });
        });
        
        // Save journal entry
        document.getElementById('journal-save-btn').addEventListener('click', () => {
            const title = document.getElementById('journal-title').value;
            const date = document.getElementById('journal-date').value;
            const content = document.getElementById('journal-content').value;
            const prayerRequests = document.getElementById('journal-prayer').value;
            const scriptureReference = document.getElementById('journal-scripture').value;
            const tagsInput = document.getElementById('journal-tags').value;
            
            if (!title || !content) {
                alert('Please enter a title and your thoughts');
                return;
            }
            
            if (!selectedMood) {
                alert('Please select how you are feeling today');
                return;
            }
            
            // Process tags
            const tags = tagsInput.split(',')
                .map(tag => tag.trim())
                .filter(tag => tag.length > 0);
            
            // Create new entry
            const newEntry = {
                id: Date.now().toString(),
                title,
                date,
                mood: selectedMood,
                content,
                prayerRequests,
                scriptureReference,
                tags,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            // Add to journal entries
            journalEntries.unshift(newEntry);
            
            // Save to localStorage
            localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
            
            // Reset form
            document.getElementById('journal-title').value = '';
            document.getElementById('journal-date').valueAsDate = new Date();
            document.getElementById('journal-content').value = '';
            document.getElementById('journal-prayer').value = '';
            document.getElementById('journal-scripture').value = '';
            document.getElementById('journal-tags').value = '';
            moodOptions.forEach(opt => opt.classList.remove('selected'));
            selectedMood = null;
            
            // Update journal entries list
            renderJournalEntries();
            
            // Show success message
            alert('Journal entry saved successfully!');
        });
        
        // Render journal entries
        function renderJournalEntries() {
            const entriesList = document.getElementById('journal-entries-list');
            const noEntriesMessage = document.getElementById('no-entries-message');
            
            if (journalEntries.length === 0) {
                noEntriesMessage.style.display = 'block';
                entriesList.innerHTML = '';
                return;
            }
            
            noEntriesMessage.style.display = 'none';
            
            // Filter entries based on search and filters
            const searchTerm = document.getElementById('journal-search').value.toLowerCase();
            const moodFilter = document.getElementById('journal-filter-mood').value;
            const dateFilter = document.getElementById('journal-filter-date').value;
            
            let filteredEntries = journalEntries;
            
            // Apply search filter
            if (searchTerm) {
                filteredEntries = filteredEntries.filter(entry => 
                    entry.title.toLowerCase().includes(searchTerm) ||
                    entry.content.toLowerCase().includes(searchTerm) ||
                    entry.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                );
            }
            
            // Apply mood filter
            if (moodFilter) {
                filteredEntries = filteredEntries.filter(entry => entry.mood === moodFilter);
            }
            
            // Apply date filter
            if (dateFilter) {
                const now = new Date();
                let startDate;
                
                if (dateFilter === 'week') {
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 7);
                } else if (dateFilter === 'month') {
                    startDate = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
                } else if (dateFilter === 'year') {
                    startDate = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
                }
                
                filteredEntries = filteredEntries.filter(entry => {
                    const entryDate = new Date(entry.date);
                    return entryDate >= startDate;
                });
            }
            
            // Generate HTML for entries
            let entriesHTML = '';
            
            filteredEntries.forEach(entry => {
                const formattedDate = new Date(entry.date).toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                const moodIcon = getMoodIcon(entry.mood);
                
                let tagsHTML = '';
                if (entry.tags && entry.tags.length > 0) {
                    tagsHTML = entry.tags.map(tag => `<span class="journal-tag">${tag}</span>`).join('');
                }
                
                entriesHTML += `
                    <div class="journal-entry" data-id="${entry.id}">
                        <div class="journal-entry-header">
                            <div class="journal-entry-title">${entry.title}</div>
                            <div class="journal-entry-date">${formattedDate}</div>
                        </div>
                        <div class="journal-entry-mood">
                            <i class="${moodIcon}"></i> ${capitalizeFirstLetter(entry.mood)}
                        </div>
                        <p>${entry.content.substring(0, 150)}${entry.content.length > 150 ? '...' : ''}</p>
                        <div class="journal-entry-tags">
                            ${tagsHTML}
                        </div>
                        <div class="journal-actions">
                            <button class="journal-action-btn view-entry" data-id="${entry.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="journal-action-btn edit-entry" data-id="${entry.id}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="journal-action-btn delete-entry" data-id="${entry.id}">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                            <button class="journal-action-btn speak-entry" data-id="${entry.id}">
                                <i class="fas fa-volume-up"></i> Listen
                            </button>
                        </div>
                    </div>
                `;
            });
            
            entriesList.innerHTML = entriesHTML;
            
            // Add event listeners for entry actions
            document.querySelectorAll('.view-entry').forEach(btn => {
                btn.addEventListener('click', viewEntry);
            });
            
            document.querySelectorAll('.edit-entry').forEach(btn => {
                btn.addEventListener('click', editEntry);
            });
            
            document.querySelectorAll('.delete-entry').forEach(btn => {
                btn.addEventListener('click', deleteEntry);
            });
            
            document.querySelectorAll('.speak-entry').forEach(btn => {
                btn.addEventListener('click', speakEntry);
            });
        }
        
        // Helper functions
        function getMoodIcon(mood) {
            const icons = {
                joyful: 'fas fa-smile-beam',
                peaceful: 'fas fa-dove',
                anxious: 'fas fa-wind',
                sad: 'fas fa-cloud-rain',
                confused: 'fas fa-question-circle',
                grateful: 'fas fa-pray'
            };
            
            return icons[mood] || 'fas fa-meh';
        }
        
        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }
        
        // Entry actions
        function viewEntry(e) {
            const entryId = e.currentTarget.getAttribute('data-id');
            const entry = journalEntries.find(entry => entry.id === entryId);
            
            if (!entry) return;
            
            const formattedDate = new Date(entry.date).toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            const moodIcon = getMoodIcon(entry.mood);
            
            let tagsHTML = '';
            if (entry.tags && entry.tags.length > 0) {
                tagsHTML = entry.tags.map(tag => `<span class="journal-tag">${tag}</span>`).join('');
            }
            
            let scriptureHTML = '';
            if (entry.scriptureReference) {
                scriptureHTML = `
                    <div style="margin-top: 20px;">
                        <strong>Scripture Connection:</strong>
                        <p>${entry.scriptureReference}</p>
                    </div>
                `;
            }
            
            let prayerHTML = '';
            if (entry.prayerRequests) {
                prayerHTML = `
                    <div style="margin-top: 20px;">
                        <strong>Prayer Requests:</strong>
                        <p>${entry.prayerRequests}</p>
                    </div>
                `;
            }
            
            showResponse(`
                <div style="padding: 20px;">
                    <h2 style="margin-bottom: 10px;">${entry.title}</h2>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <div>${formattedDate}</div>
                        <div><i class="${moodIcon}"></i> ${capitalizeFirstLetter(entry.mood)}</div>
                    </div>
                    <div style="white-space: pre-line;">${entry.content}</div>
                    ${scriptureHTML}
                    ${prayerHTML}
                    <div style="margin-top: 20px;">
                        ${tagsHTML}
                    </div>
                    <div style="margin-top: 30px;">
                        <button class="submit-btn" id="back-to-journal" style="background: var(--dark);">
                            <i class="fas fa-arrow-left"></i> Back to Journal
                        </button>
                    </div>
                </div>
            `);
            
            document.getElementById('back-to-journal').addEventListener('click', () => {
                document.querySelector('[data-tab="journal"]').click();
            });
        }
        
        function editEntry(e) {
            const entryId = e.currentTarget.getAttribute('data-id');
            const entry = journalEntries.find(entry => entry.id === entryId);
            
            if (!entry) return;
            
            // Fill form with entry data
            document.getElementById('journal-title').value = entry.title;
            document.getElementById('journal-date').value = entry.date;
            document.getElementById('journal-content').value = entry.content;
            document.getElementById('journal-prayer').value = entry.prayerRequests || '';
            document.getElementById('journal-scripture').value = entry.scriptureReference || '';
            document.getElementById('journal-tags').value = entry.tags ? entry.tags.join(', ') : '';
            
            // Select mood
            moodOptions.forEach(option => {
                if (option.getAttribute('data-mood') === entry.mood) {
                    option.click();
                }
            });
            
            // Change save button to update
            const saveBtn = document.getElementById('journal-save-btn');
            saveBtn.innerHTML = '<i class="fas fa-save"></i> Update Entry';
            saveBtn.setAttribute('data-edit-id', entryId);
            
            // Scroll to form
            document.getElementById('journal-form').scrollIntoView({ behavior: 'smooth' });
            
            // Change save button behavior
            saveBtn.removeEventListener('click', saveEntry);
            saveBtn.addEventListener('click', updateEntry);
        }
        
        function updateEntry() {
            const saveBtn = document.getElementById('journal-save-btn');
            const entryId = saveBtn.getAttribute('data-edit-id');
            
            if (!entryId) return;
            
            const title = document.getElementById('journal-title').value;
            const date = document.getElementById('journal-date').value;
            const content = document.getElementById('journal-content').value;
            const prayerRequests = document.getElementById('journal-prayer').value;
            const scriptureReference = document.getElementById('journal-scripture').value;
            const tagsInput = document.getElementById('journal-tags').value;
            
            if (!title || !content) {
                alert('Please enter a title and your thoughts');
                return;
            }
            
            if (!selectedMood) {
                alert('Please select how you are feeling today');
                return;
            }
            
            // Process tags
            const tags = tagsInput.split(',')
                .map(tag => tag.trim())
                .filter(tag => tag.length > 0);
            
            // Find entry index
            const entryIndex = journalEntries.findIndex(entry => entry.id === entryId);
            
            if (entryIndex === -1) return;
            
            // Update entry
            journalEntries[entryIndex] = {
                ...journalEntries[entryIndex],
                title,
                date,
                mood: selectedMood,
                content,
                prayerRequests,
                scriptureReference,
                tags,
                updatedAt: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
            
            // Reset form
            document.getElementById('journal-title').value = '';
            document.getElementById('journal-date').valueAsDate = new Date();
            document.getElementById('journal-content').value = '';
            document.getElementById('journal-prayer').value = '';
            document.getElementById('journal-scripture').value = '';
            document.getElementById('journal-tags').value = '';
            moodOptions.forEach(opt => opt.classList.remove('selected'));
            selectedMood = null;
            
            // Reset save button
            saveBtn.innerHTML = '<i class="fas fa-save"></i> Save Entry';
            saveBtn.removeAttribute('data-edit-id');
            
            // Remove update event listener and add save event listener
            saveBtn.removeEventListener('click', updateEntry);
            saveBtn.addEventListener('click', saveEntry);
            
            // Update journal entries list
            renderJournalEntries();
            
            // Show success message
            alert('Journal entry updated successfully!');
        }
        
        function deleteEntry(e) {
            const entryId = e.currentTarget.getAttribute('data-id');
            
            if (confirm('Are you sure you want to delete this journal entry? This cannot be undone.')) {
                // Remove entry from array
                journalEntries = journalEntries.filter(entry => entry.id !== entryId);
                
                // Save to localStorage
                localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
                
                // Update journal entries list
                renderJournalEntries();
                
                // Show success message
                alert('Journal entry deleted successfully!');
            }
        }
        
        // Initialize journal entries list
        renderJournalEntries();
        
        // Add event listeners for filters
        document.getElementById('journal-search').addEventListener('input', renderJournalEntries);
        document.getElementById('journal-filter-mood').addEventListener('change', renderJournalEntries);
        document.getElementById('journal-filter-date').addEventListener('change', renderJournalEntries);

        // Voice Recognition Functionality
        let recognition;
        let isRecognizing = false;
        let currentVoiceInput = null;
        
        // Check if browser supports speech recognition
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const SpeechGrammarList = window.SpeechGrammarList || window.webkitSpeechGrammarList;
        const SpeechRecognitionEvent = window.SpeechRecognitionEvent || window.webkitSpeechRecognitionEvent;
        
        if (SpeechRecognition) {
            // Initialize speech recognition
            recognition = new SpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = 'en-US';
            
            // Handle recognition results
            recognition.onresult = (event) => {
                let interimTranscript = '';
                let finalTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript;
                    } else {
                        interimTranscript += transcript;
                    }
                }
                
                // Update the current input field
                if (currentVoiceInput) {
                    if (currentVoiceInput.tagName === 'TEXTAREA') {
                        // For textarea, append the text
                        currentVoiceInput.value += finalTranscript + ' ';
                        
                        // Update transcript display if it's the journal content
                        if (currentVoiceInput.id === 'journal-content') {
                            const transcriptEl = document.getElementById('journal-transcript');
                            transcriptEl.textContent = interimTranscript;
                            transcriptEl.classList.add('active');
                        }
                    } else {
                        // For input fields, replace the text
                        currentVoiceInput.value = finalTranscript;
                    }
                }
            };
            
            // Handle recognition end
            recognition.onend = () => {
                isRecognizing = false;
                
                // Reset voice buttons
                document.querySelectorAll('.voice-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Hide voice controls
                document.getElementById('journal-voice-pause').style.display = 'none';
                document.getElementById('journal-voice-stop').style.display = 'none';
                
                // Update status
                const statusEl = document.getElementById('journal-voice-status');
                if (statusEl) {
                    statusEl.textContent = 'Click the microphone to start speaking';
                }
                
                // Hide transcript
                const transcriptEl = document.getElementById('journal-transcript');
                if (transcriptEl) {
                    transcriptEl.classList.remove('active');
                }
            };
            
            // Handle recognition errors
            recognition.onerror = (event) => {
                console.error('Speech recognition error', event.error);
                
                // Update status
                const statusEl = document.getElementById('journal-voice-status');
                if (statusEl) {
                    statusEl.textContent = `Error: ${event.error}. Please try again.`;
                }
                
                // Reset voice buttons
                document.querySelectorAll('.voice-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                isRecognizing = false;
            };
            
            // Add event listeners to voice buttons
            document.querySelectorAll('.voice-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    // Get the input field associated with this button
                    const inputId = btn.id.replace('-voice', '');
                    currentVoiceInput = document.getElementById(inputId);
                    
                    if (!currentVoiceInput) return;
                    
                    if (isRecognizing) {
                        // Stop recognition if already running
                        recognition.stop();
                        isRecognizing = false;
                        btn.classList.remove('active');
                        
                        // Hide voice controls
                        document.getElementById('journal-voice-pause').style.display = 'none';
                        document.getElementById('journal-voice-stop').style.display = 'none';
                        
                        // Update status
                        const statusEl = document.getElementById('journal-voice-status');
                        if (statusEl) {
                            statusEl.textContent = 'Click the microphone to start speaking';
                        }
                    } else {
                        // Start recognition
                        try {
                            recognition.start();
                            isRecognizing = true;
                            btn.classList.add('active');
                            
                            // Show voice controls for journal content
                            if (inputId === 'journal-content') {
                                document.getElementById('journal-voice-pause').style.display = 'inline-flex';
                                document.getElementById('journal-voice-stop').style.display = 'inline-flex';
                                
                                // Update status
                                const statusEl = document.getElementById('journal-voice-status');
                                if (statusEl) {
                                    statusEl.textContent = 'Listening... Speak now';
                                }
                                
                                // Show transcript
                                const transcriptEl = document.getElementById('journal-transcript');
                                if (transcriptEl) {
                                    transcriptEl.classList.add('active');
                                }
                            }
                        } catch (error) {
                            console.error('Speech recognition error', error);
                        }
                    }
                });
            });
            
            // Add event listeners for voice controls
            document.getElementById('journal-voice-pause').addEventListener('click', () => {
                if (isRecognizing) {
                    recognition.stop();
                    isRecognizing = false;
                    
                    // Update button text
                    document.getElementById('journal-voice-pause').innerHTML = '<i class="fas fa-play"></i> Resume';
                    
                    // Update status
                    const statusEl = document.getElementById('journal-voice-status');
                    if (statusEl) {
                        statusEl.textContent = 'Paused. Click Resume to continue.';
                    }
                } else {
                    try {
                        recognition.start();
                        isRecognizing = true;
                        
                        // Update button text
                        document.getElementById('journal-voice-pause').innerHTML = '<i class="fas fa-pause"></i> Pause';
                        
                        // Update status
                        const statusEl = document.getElementById('journal-voice-status');
                        if (statusEl) {
                            statusEl.textContent = 'Listening... Speak now';
                        }
                    } catch (error) {
                        console.error('Speech recognition error', error);
                    }
                }
            });
            
            document.getElementById('journal-voice-stop').addEventListener('click', () => {
                if (isRecognizing) {
                    recognition.stop();
                    isRecognizing = false;
                    
                    // Reset voice buttons
                    document.querySelectorAll('.voice-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Hide voice controls
                    document.getElementById('journal-voice-pause').style.display = 'none';
                    document.getElementById('journal-voice-stop').style.display = 'none';
                    
                    // Update status
                    const statusEl = document.getElementById('journal-voice-status');
                    if (statusEl) {
                        statusEl.textContent = 'Click the microphone to start speaking';
                    }
                    
                    // Hide transcript
                    const transcriptEl = document.getElementById('journal-transcript');
                    if (transcriptEl) {
                        transcriptEl.classList.remove('active');
                    }
                }
            });
        } else {
            // Hide voice buttons if speech recognition is not supported
            document.querySelectorAll('.voice-btn').forEach(btn => {
                btn.style.display = 'none';
            });
            
            // Hide voice controls
            document.getElementById('journal-voice-pause').style.display = 'none';
            document.getElementById('journal-voice-stop').style.display = 'none';
            
            // Update status
            const statusEl = document.getElementById('journal-voice-status');
            if (statusEl) {
                statusEl.textContent = 'Voice input is not supported in your browser.';
            }
        }

        // Text-to-Speech Functionality
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let isSpeaking = false;
        
        // Function to speak text
        function speakText(text) {
            if (!speechSynthesis) return;
            
            // Cancel any ongoing speech
            speechSynthesis.cancel();
            
            // Create a new utterance
            const utterance = new SpeechSynthesisUtterance(text);
            
            // Set language
            utterance.lang = 'en-US';
            
            // Set voice (optional)
            const voices = speechSynthesis.getVoices();
            const preferredVoice = voices.find(voice => voice.name.includes('Female') || voice.name.includes('Google'));
            if (preferredVoice) {
                utterance.voice = preferredVoice;
            }
            
            // Set properties
            utterance.rate = 1.0;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            // Store current utterance
            currentUtterance = utterance;
            isSpeaking = true;
            
            // Update speak button
            const speakBtn = document.getElementById('speak-response-btn');
            speakBtn.innerHTML = '<i class="fas fa-pause"></i>';
            
            // Handle speech end
            utterance.onend = () => {
                isSpeaking = false;
                currentUtterance = null;
                
                // Update speak button
                speakBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
            };
            
            // Speak the text
            speechSynthesis.speak(utterance);
        }
        
        // Function to pause/resume speech
        function toggleSpeech() {
            if (!speechSynthesis) return;
            
            if (isSpeaking) {
                // Pause speech
                speechSynthesis.pause();
                isSpeaking = false;
                
                // Update speak button
                document.getElementById('speak-response-btn').innerHTML = '<i class="fas fa-play"></i>';
            } else {
                // Resume speech
                speechSynthesis.resume();
                isSpeaking = true;
                
                // Update speak button
                document.getElementById('speak-response-btn').innerHTML = '<i class="fas fa-pause"></i>';
            }
        }
        
        // Function to stop speech
        function stopSpeech() {
            if (!speechSynthesis) return;
            
            // Cancel speech
            speechSynthesis.cancel();
            isSpeaking = false;
            currentUtterance = null;
            
            // Update speak button
            document.getElementById('speak-response-btn').innerHTML = '<i class="fas fa-volume-up"></i>';
        }
        
        // Add event listener to speak button
        document.getElementById('speak-response-btn').addEventListener('click', () => {
            if (isSpeaking) {
                toggleSpeech();
            } else {
                // Get text to speak
                const responseText = responseContent.textContent;
                speakText(responseText);
            }
        });
        
        // Function to speak journal entry
        function speakEntry(e) {
            const entryId = e.currentTarget.getAttribute('data-id');
            const entry = journalEntries.find(entry => entry.id === entryId);
            
            if (!entry) return;
            
            // Create text to speak
            let textToSpeak = `Journal entry: ${entry.title}. `;
            textToSpeak += `Date: ${new Date(entry.date).toLocaleDateString()}. `;
            textToSpeak += `Mood: ${entry.mood}. `;
            textToSpeak += `${entry.content}`;
            
            if (entry.scriptureReference) {
                textToSpeak += ` Scripture connection: ${entry.scriptureReference}.`;
            }
            
            if (entry.prayerRequests) {
                textToSpeak += ` Prayer requests: ${entry.prayerRequests}.`;
            }
            
            // Speak the text
            speakText(textToSpeak);
        }
        
        // Initialize voices when they are available
        speechSynthesis.onvoiceschanged = () => {
            // This event fires when voices are available
            console.log('Voices loaded:', speechSynthesis.getVoices().length);
        };
        
        // Make sure voices are loaded
        if (speechSynthesis.getVoices().length === 0) {
            speechSynthesis.getVoices();
        }
    </script>
</body>
</html>
